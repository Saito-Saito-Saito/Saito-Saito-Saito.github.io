<html lang="en">
<head>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-166967736-1"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-166967736-1');
    </script>

    <title>Pythonプログラミングでゲームを作るメモ　ログ</title>
    
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta property="og:url" content="https://Saito-Saito-Saito.github.io/memorandom/Python/logging">
    <meta property="og:title" content="Pythonプログラミングでゲームを作るメモ　ログ">
    <meta name="og:description" content="Pythonプログラミングによって、ターミナル上で実行できるいろいろなゲームを制作するときの、ログにまつわる備忘録です。">
    <meta name="description" content="Pythonプログラミングによって、ターミナル上で実行できるいろいろなゲームを制作するときの、ログにまつわる備忘録です。">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="twitter:card" content="summary_large_image"/>
    <meta property="og:image" content="https://Saito-Saito-Saito.github.io/unagi-study.JPG">

    <link rel="icon" href="https://Saito-Saito-Saito.github.io/icon.png">
    <link rel="stylesheet" href="../../stylesheet.css">
</head>
<body>
    <header>
        <img src="../../../unagi-top.png" alt="" width="90px">
        <div id="title">
            <h1>Pythonプログラミングで</h1>
            <h1>ログのメモ</h1>
        </div>
    </header>

    <div id="menu-bar">
        <div id="short-menu">
            <input type="checkbox" id="acd-check">
            <table>
                <tr><td><a href="https://Saito-Saito-Saito.github.io/memorandom">HOME</a></td><td><label for="acd-check">CONTENTS</label></td>
                </tr>
            </table>
            <ul class="stages-menu">
                <li><a href="https://Saito-Saito-Saito.github.io/memorandom/Python/class">クラス</a></li>
                <li><a href="https://Saito-Saito-Saito.github.io/memorandom/Python/functions">関数</a></li>
                <li><a href="https://Saito-Saito-Saito.github.io/memorandom/Python/list">リスト</a></li>
                <li><a href="https://Saito-Saito-Saito.github.io/memorandom/Python/logging">ログ</a></li>
                <li><a href="https://Saito-Saito-Saito.github.io/memorandom/Python/random">乱数</a></li>
                <li><a href="https://Saito-Saito-Saito.github.io/memorandom/Python/str">文字列</a></li>
            </ul>
        </div>
        <div id="long-menu">
            <table>
                <tr>
                    <td><a href="https://Saito-Saito-Saito.github.io/memorandom">HOME</a></td>
                    <td><a href="https://Saito-Saito-Saito.github.io/memorandom/Python/class">クラス</a></td>
                    <td><a href="https://Saito-Saito-Saito.github.io/memorandom/Python/functions">関数</a></td>
                    <td><a href="https://Saito-Saito-Saito.github.io/memorandom/Python/list">リスト</a></td>
                    <td><a href="https://Saito-Saito-Saito.github.io/memorandom/Python/logging">ログ</a></td>
                    <td><a href="https://Saito-Saito-Saito.github.io/memorandom/Python/random">乱数</a></td>
                    <td><a href="https://Saito-Saito-Saito.github.io/memorandom/Python/str">文字列</a></td>
                </tr>
            </table>
        </div>
    </div>

    <main>
        <section class="index">
            <h2>目次</h2>
            <p>
                <ul>
                    <li><a href="#vocabulary">語彙</a></li>
                    <li><a href="#levels">レベル</a></li>
                    <li><a href="#logger">ロガー</a></li>
                </ul>
            </p>
        </section>

        <section id="vocabulary">
            <h2>語彙</h2>
            <h3 id="level_v">レベル</h3>
            <p>ログにつける表示の優先順位。<a href="#levels">レベルについての解説</a>参照。</p>
            <h3 id="logger_v">ロガー</h3>
            <p>ログを分割してまとめ上げる<a href="https://Saito-Saito-Saito.github.io/memorandom/Python/class#instance_v" class="memo" target="_new">インスタンス</a>。<a href="#logger">ロガーについての解説</a>参照。</p>
            <h3 id="handler_v">ハンドラー</h3>
            <p>ログを表示するターミナルやファイルなどの動態を記述する<a href="https://Saito-Saito-Saito.github.io/memorandom/Python/class#instance_v" class="memo" target="_new">インスタンス</a>。<a href="#logger">ロガーについての解説</a>参照。</p>
            <h3 id="filehandler_v">ファイルハンドラー</h3>
            <p>テキストファイルなどの形でログを出力するための<a href="#handler_v" class="memo">ハンドラー</a>。<a href="#logger">ロガーについての解説</a>参照。</p>
            <h3 id="streamhandler_v">ストリームハンドラー</h3>
            <p>ターミナルにログを表示するための<a href="#handler_v" class="memo">ハンドラー</a>。<a href="#logger">ロガーについての解説</a>参照。</p>
        </section>

        <section id="levels">
            <h2>レベル</h2>
            <table width="90%" border="1" style="max-width: 450px; margin: 0 5%;border: solid black 1px; border-collapse: collapse;">
                <tr><th>タスク</th><th>最適なレベル</th></tr>
                <tr><td>問題を診断するときのみに関心のある詳細な情報</td><td><code>logging.DEBUG</code></td></tr>
                <tr><td>想定通りのことが起こったことの確認</td><td><code>logging.INFO</code></td></tr>
                <tr><td>想定外のことが起こった、もしくは起こりそうなことの警告</td><td><code>logging.WARNING</code></td></tr>
                <tr><td>より重大な問題によって、ソフトウェアがある機能を実行できないことの表示</td><td><code>logging.ERROR</code></td></tr>
                <tr><td>プログラム自体が実行できないような重大なエラー</td><td><code>logging.CRITICAL</code></td></tr>
            </table>
            <p>デフォルトのレベルは WARNING です。つまり特段設定をしなければ WARNING, ERROR, CRITICAL のレベルのログが出力されます。</p>
        </section>

        <section id="logger">
            <h2>ロガー</h2>
            <p>ログの機能は基本的にロガーという<a href="https://Saito-Saito-Saito.github.io/memorandom/Python/class" class="memo" target="_new">インスタンス</a>を使って実装するのが望ましいとされています。というのは、ログを確認するときに用途別などカテゴライズができるからです。その有用性などについてはこちらのサイトで力説されていますので、ぜひ参考になさってください。</p>
            <p><a href="https://qiita.com/amedama/items/b856b2f30c2f38665701">ログ出力のための print と import logging はやめてほしい</a></p>
            <p>ではどのようにロガーを使えばいいか。まずはこちらのコードをご覧ください。</p>
            <div class="real-code">
                <pre>
                    <code>
import logging

# declaring the logger
logger = logging.getLogger("logger1")
logger.setLevel(logging.DEBUG)

# getting stream handler (written on the terminal)
handler_s = logging.StreamHandler()
handler_s.setLevel(logging.DEBUG)
logger.addHandler(handler_s)

# getting file handler (written on the file)
handler_f = logging.FileHandler('log.txt')
handler_f.setLevel(logging.INFO)
logger.addHandler(handler_f)

logger.debug('DEBUG')
logger.warning('WARNING')
                    </code>
                </pre>
            </div>
            <p>terminal</p>
            <div class="real-code">
                <pre>
                    <code>
DEBUG
WARNING
                    </code>
                </pre>
            </div>
            <p>log.txt</p>
            <p class="real-code"><code>WARNING</code></p>
            <p>基本の表し方はこの通りです。</p>
            <p>まずロガー本体を宣言します。getLogger の引数がログを表示して区別するときに確認できるロガーの名前となり、名前を logger1 としました。「でも logger1 なんて他にはどこにも出てきてないじゃん」となった方は、もう少し待っててください。ちゃんと説明します。</p>
            <p>その次の setLevel はロガーが受け付けるログの最低レベルを設定しています。ここでは「DEBUG 以上（つまり全部）のログを記録しておきますよ」ということ。</p>
            <p>その次が stream handler の設定です。コードの実行途中にターミナルで表示するログですね。setLevel でターミナルに表示するレベルの下限を設定します。addHandler でロガーに適用です。</p>
            <p>その後に file handler を設定します。別ファイルにログをまとめて書き出すものです。今回は log.txt というファイルに書き出します。もしその名前のファイルが存在しなければ新規作成します。残りは stream handler とほぼ同じですね。レベルだけは INFO 以上、つまり DEBUG を表示しないようにしています。ターミナルとファイルのそれぞれの結果をよく照らし合わせてください。</p>
            <p>これだけだとロガーの威力はほとんど感じられないでしょうから、もう一つ例を題しておきます。ちょいと長くなりますがその点はご勘弁を。</p>
            <div class="real-code">
                <pre>
                    <code>
import logging

# declaring the loggers
logger1 = logging.getLogger("Logger1")
logger1.setLevel(logging.DEBUG)

logger2 = logging.getLogger("Logger2")
logger2.setLevel(logging.ERROR)

# getting the stream handler (written on the terminal)
handler_s = logging.StreamHandler()
handler_s.setLevel(logging.INFO)
handler_s.setFormatter(logging.Formatter('%(name)s - %(message)s'))
logger1.addHandler(handler_s)
logger2.addHandler(handler_s)

# getting the file handler (written on the file)
handler_f = logging.FileHandler('log.txt')
handler_f.setLevel(logging.DEBUG)
handler_f.setFormatter(logging.Formatter('%(asctime)s - %(levelname)s - %(name)s - %(message)s'))
logger1.addHandler(handler_f)
logger2.addHandler(handler_f)

logger1.debug('DEBUG')
logger1.warning('WARNING')
logger2.warning('WARNING')
logger2.critical('CRITICAL')
                    </code>
                </pre>
            </div>
            <p>terminal</p>
            <div class="real-code">
                <pre>
                    <code>
Logger1 - WARNING
Logger2 - CRITICAL
                    </code>
                </pre>
            </div>
            <p>log.txt</p>
            <div class="real-code">
                <pre>
                    <code>
2020-12-23 21:59:17,560 - DEBUG - Logger1 - DEBUG
2020-12-23 21:59:17,560 - WARNING - Logger1 - WARNING
2020-12-23 21:59:17,560 - CRITICAL - Logger2 - CRITICAL
                    </code>
                </pre>
            </div>
            <p>こうしてロガー別に名前を変えたりレベルを変えたりして、ログの整理を用意にすることができるようになります。</p>
        </section>
    </main>

    <footer>
        <ul>
            <li>LAST UPDATE: 2020/12/23</li>
            <li><a href="https://Saito-Saito-Saito.github.io" target="_blank">解説一覧</a></li>
            <li>
                <a href="https://github.com/Saito-Saito-Saito" target="_blank">このページの作成者のGitHub</a>
            </li>
            <li>
                <a href="https://twitter.com/zsops_n" target="_blank">このページの作成者のTwitter</a>
            </li>
            <li>
                <a href="#">トップに戻る</a>
            </li>
        </ul>
    </footer>
</body>
</html>