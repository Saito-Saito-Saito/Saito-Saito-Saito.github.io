<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stage 2</title>
    <link rel="stylesheet" href="../stylesheet.css">
</head>
<body>
    <header>
        <div id="title">
            <h1>これであなたも</h1>
            <h1>チェスが作れる</h1>
        </div>
        <ul>
            <li><a href="../index.html">Stage 0・1</a></li>
            <li><a href="#stage2">Stage 2</a></li>
            <li><a href="../stage3/index.html">Stage 3</a></li>
        </ul>
    </header>

    <main>
        <section id="stage2">
            <h1>Stage 2　プログラムの機能を考える</h1>
            <p>ここではプログラムをすること全体の指針を考えていきます。</p>
            <p>チェスを作るにあたって、まずは</p>
            <div class="stress">
                <p>2人でプレーできる</p>
            </div>
            <p>ことが機能の絶対条件と言ってもいいでしょう。これすらできないチェスのゲームは存在価値がないも同然です。</p>
            <p>ではどのように2人でプレーできるようにしましょうか。絵みたいな盤面でクリックして動かしたい？我々そんな高度な作業できませんよ。</p>
            <p>ですから、仕方なくではありますが、コマンドプロンプトで動かすのを作ってみましょう。コマンドってみなさんが「ハッカーのパソコン」と言われて真っ先に思い浮かべるあれですよ。「あんなのムリー」って？できるようになりますって。最初私もそう思ってたんですから。</p>
        </section>

        <section>
            <h2>2-1　盤面</h2>
            <p>さて、対戦できるようにコードを組みたいと思ったとき、まずその戦う場所、バトルフィールドが必要なわけです。チェスのバトルフィールドは？そう、</p>
            <div class="stress"><p>6 × 6マスのムダに白黒したあのただの板</p></div>
            <p>ですよ。あの白黒はムダなので今回は白黒なんかさせません。いや、白黒にしていいですよ。ムダなだけですから私はオススメしませんけど。</p>
            <p>コマンドで動かす以上、動かしたい駒の上でクリックして選択なんてできませんから、何らかの形でマス目の位置を指定しないといけません。実はその手段はすでに国際チェス連盟(FIDE)が定めてくれています。棋譜です。</p>
            <p>棋譜というのはそれぞれの駒の動かし方を漏らすことなく記録したものです。FIDEでは棋譜の書き方が決められており、「どこのマスか」がわかるようにマスの書き方も記載があります。公式サイトにその記述は見当たりませんでしたが、<a href="https://ja.wikipedia.org/wiki/%E6%A3%8B%E8%AD%9C#%E3%83%81%E3%82%A7%E3%82%B9%E3%81%AE%E6%A3%8B%E8%AD%9C">Wiki</a>でもどこでも探せば出てきます。ということで、盤面はこのアルファベットと数字で表される「座標」がわかるようにしておきたいですね。</p>
            <p>そうそう、せっかくマス目が座標なんだからマス目のデータも座標っぽく扱ったらいいじゃないってんで、
            </p>
            <div class="code">
                <pre>
                    <code>
board = [FILE - 1][RANK - 1]
                    </code> 
                </pre>
            </div>
            <p>の構造にしてみました。ちなみに、fileは縦の列、rankは横の列を表します。これ以降は、ソースコードなど文書を表す意味のファイルと分けるために、この2つは英文字表記で統一します。boardのインデックスに-1がついている理由はリストのインデックスが0番スタートだからです。fileはaからhのアルファベットで表しますから、できればこのままソースコードに使えるようにと</p>
            <div class="code">
                <pre>
a, b, ..., h = 1, 2, ..., 8
                </pre>
            </div>
            <p>と表しておきます。こうすれば「あれ、これタテだっけヨコだっけ？」って困惑することも少なくなります。そもそも見やすい。</p>
        </section>

        <section>
            <h2>2-2　駒</h2>
            <p>チェスに限らず、ボードゲームのルールを覚えるというのはほぼ「駒の動き方」を覚えるにほかならないでしょう。これをコンピューターにも覚えさせなければいけません。</p>
            <p>駒の動きというのは「この方向に何マス進めますよ」という表し方になります。ですから、チェスの駒は
            </p>
            <div class="stress"><p>行先と現在位置の座標から</p></div>
            <p>正しい動きをしているかがわかります。タテの列は何列ぶんズレたかとか、何行ぶん下がったかとか、そうして正しい動きをしているか判定するわけです。そう、駒の動きは</p>
            <div class="stress"><p>正しい動きをしているか判定する機能</p></div>
            <p>によってコンピューターに覚えさせるのです。</p>
            <p>「いや、判定だけしたって動かせねーじゃん」って、まあその通りですよ。だから動かす機能も付けます。その話の前に、チェスには6種類の駒が白黒両陣営に16個ずつあります。これをどうやって表すか。さっきboardっていって2重リスト考えたでしょ。あれに値突っ込んでおきゃいいんじゃないですか。例えばWHITEを1, ROOKを2にして</p>
            <div class="code">
                <pre>
                    <code>
board[a - 1][6 - 1] = WHITE * ROOK
                    </code>
                </pre>
            </div>
            <p>って表すとか。<code>BLACK = -1</code>ってやればboardの値の正負でどっちのものかわかりますし。ということで</p>
            <div class="stress">board[FILE][RANK] = PLAYER * PIECE</div>
            <p>という構造を使っていきます。プレーヤーが駒を動かすのは、2-1で言った「棋譜」の書き方でいいと思います。やたらめったら変な書き方じゃあ汎用性低いですから。</p>
            <p>これでチェスのゲームをやるのに最低限必要な機能は揃いました。あとは補助的な、「これがあるとゲームっぽい」という機能を加えていきます。</p>
        </section>

        <section>
            <h2>2-3　勝敗</h2>
            <p>まあ勝敗なんて当人たちが勝手につければいいんですよ。いいんですけど、そりゃあゲーム作るうえで "GAME OVER..." みたいなのやりたいじゃないですか。やっぱし作りたいじゃないですか。それに棋譜では「チェックメイトの手」という記述をすることもあるくらいです。そんなワガママなプレーヤーさんのためにも勝敗判定してあげましょうよ。</p>
            <p>チェスにおいて勝敗は白黒と引き分けの3種類、勝敗のつきかたはチェックメイト・ステイルメイト・投了の3種類です。わからない人はもう一度ルールを確認しましょう。これをそれぞれ判断する機能も付けたいですね。</p>
            <p>チェックメイトを判断するには何よりチェックを判断できるようにならなければいけません。でもそんな難しいことではありませんよ。だって「相手のキングのいるマスに行けるか」判定すればいいんですから。そしてチェックの機能を使って「どうやって動いてもチェック」であればチェックメイトと判断すればいい。ステイルメイトだって、「どうやって動いてもチェックされる」ということを判断すればいいので、そう頭を抱える問題ではありません。
            </p>
        </section>

        <section>
            <h2>次回予告</h2>
            <p>だいたいの概要が決まったところで、今度は本格的にコードを書いていきます。プログラムを書く準備はできているでしょうか。まあ、最初はボードゲーム作ったことのある人ならだれでもやったことがある「2次元配列」です。「それなら復習だぜ」って人もいるでしょうから、気楽に見ていきましょう。</p>
            <p><a href="../stage3/index.html">次回　Stage 3　盤面をつくる</a></p>
        </section>
    </main>

    <footer>
        <ul>
            <li>
                <a href="https://github.com/Saito-Saito-Saito">このページの作成者のGitHub</a>
            </li>
            <li>
                <a href="https://twitter.com/zsops_n">このページの作成者のTwitter</a>
            </li>
            <li>
                <a href="#">トップに戻る</a>
            </li>
        </ul>
    </footer>
</body>
</html>