<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>これであなたもチェスが作れる 2</title>
    <link rel="stylesheet" href="../stylesheet.css">
</head>
<body>
    <header>
        <div id="title">
            <h1>これであなたも</h1>
            <h1>チェスが作れる</h1>
        </div>
        <ul>
            <li><a href="../index.html">Stage 0&1</a></li>
            <li><a href="#">Stage 2</a></li>
            <li><a href="../stage3/index.html">Stage 3</a></li>
            <li><a href="../stage4-1/index.html">Stage 4-1</a></li>
            <li><a href="../stage4-2/index.html">Stage 4-2</a></li>
            <li><a href="../stage5/index.html">Stage 5</a></li>
            <li><a href="../stage6/index.html">Stage 6</a></li>
            <li><a href="../stage7/index.html">Stage 7</a></li>
            <li><a href="../stage8/index.html">Stage 8</a></li>
            <li><a href="../stage9/index.html">Stage 9</a></li>
            <li><a href="https://github.com/Saito-Saito-Saito/chess" target="_blank">Code</a></li>
        </ul>
    </header>

    <div class="acd-menu">
        <input type="checkbox" id="acd-check">
        <label for="acd-check" class="acd-label">MENU</label>
        <ul class="acd-content">
            <li><a href="../index.html">Stage 0&1</a></li>
            <li><a href="#">Stage 2</a></li>
            <li><a href="../stage3/index.html">Stage 3</a></li>
            <li><a href="../stage4-1/index.html">Stage 4-1</a></li>
            <li><a href="../stage4-2/index.html">Stage 4-2</a></li>
            <li><a href="../stage5/index.html">Stage 5</a></li>
            <li><a href="../stage6/index.html">Stage 6</a></li>
            <li><a href="../stage7/index.html">Stage 7</a></li>
            <li><a href="../stage8/index.html">Stage 8</a></li>
            <li><a href="../stage9/index.html">Stage 9</a></li>
            <li><a href="https://github.com/Saito-Saito-Saito/chess" target="_blank">Code</a></li>
        </ul>
    </div>

    <main>
        <section id="s2">
            <h1>Stage 2　プログラムの機能を考える</h1>
            <p>ここではプログラムをすること全体の指針を考えていきます。</p>
            <p>チェスを作るにあたって、まずは</p>
            <div class="stress">
                <p>2人でプレーできる</p>
            </div>
            <p>ことが機能の絶対条件と言ってもいいでしょう。これすらできないチェスのゲームは存在価値がないも同然です。</p>
            <p>ではどのように2人でプレーできるようにしましょうか。絵みたいな盤面でクリックして動かしたい？我々そんな高度な作業できませんよ。</p>
            <p>ですから、仕方なくではありますが、コマンドプロンプトで動かすのを作ってみましょう。コマンドってみなさんが「ハッカーのパソコン」と言われて真っ先に思い浮かべるあれですよ。「あんなのムリー」って？できるようになりますって。最初私もそう思ってたんですから。</p>
        </section>

        <section class="index">
            <h2>目次</h2>
            <ul>
                <li><a href="#s2-1">2-1　盤面</a></li>
                <li><a href="#s2-2">2-2　駒</a></li>
                <li><a href="#s2-3">2-3　勝敗</a></li>
            </ul>
        </section>

        <section id="s2-1">
            <h2>2-1　盤面</h2>
            <p>さて、対戦できるようにコードを組みたいと思ったとき、まずその戦う場所、バトルフィールドが必要なわけです。チェスのバトルフィールドは？そう、</p>
            <div class="stress"><p>6 × 6マスのムダに白黒したあのただの板</p></div>
            <p>ですよ。あの白黒はムダなので今回は白黒なんかさせません。いや、白黒にしていいですよ。ムダなだけですから私はオススメしませんけど。</p>
            <p>コマンドで動かす以上、動かしたい駒の上でクリックして選択なんてできませんから、何らかの形でマス目の位置を指定しないといけません。実はその手段はすでに国際チェス連盟(FIDE)が定めてくれています。棋譜です。</p>
            <p>棋譜というのはそれぞれの駒の動かし方を漏らすことなく記録したものです。FIDEでは棋譜の書き方が決められており、「どこのマスか」がわかるようにマスの書き方も記載があります。公式サイトにその記述は見当たりませんでしたが、<a href="https://ja.wikipedia.org/wiki/%E6%A3%8B%E8%AD%9C#%E3%83%81%E3%82%A7%E3%82%B9%E3%81%AE%E6%A3%8B%E8%AD%9C" target="_blank">Wiki</a>でもどこでも探せば出てきます。ということで、盤面はこのアルファベットと数字で表される「座標」がわかるようにしておきたいですね。</p>
            <p>そうそう、せっかくマス目が座標なんだからマス目のデータも座標っぽく扱ったらいいじゃないってんで、
            </p>
            <div class="code">
                <pre>
                    <code>
board = [FILE][RANK]
                    </code> 
                </pre>
            </div>
            <p>の構造にしてみました。ちなみに、file は縦の列、rank は横の列を表します。リストのインデックスですから、当然 0 番スタートです。これ以降はソースコードなど文書を表す意味のファイルと分けるために、file と rank の 2 つは英文字表記で統一します。board のインデックスに -1 がついている理由はリストのインデックスが 0 番スタートだからです。file は a から h のアルファベットで表しますから、できればこのままソースコードに使えるようにと</p>
            <div class="code">
                <pre>
a, b, ..., h = 1, 2, ..., 8
                </pre>
            </div>
            <p>と定義しておきます。こうすれば「あれ、これタテだっけヨコだっけ？」って困惑することも少なくなります。そもそも見やすい。</p>
        </section>

        <section id="s2-2">
            <h2>2-2　駒</h2>
            <p>チェスに限らず、ボードゲームのルールを覚えるというのはほぼ「駒の動き方」を覚えるにほかならないでしょう。これをコンピューターにもさせなければいけません。</p>
            <p>チェスの棋譜において、駒の動きというのは「この方向に何マス進めますよ」という表し方になります。ですから、チェスの駒は
            </p>
            <div class="stress"><p>行先と現在位置の座標から</p></div>
            <p>正しい動きをしているかがわかります。何列ぶんヨコにズレたかとか、上から下に何行ぶん下がったかとか、そうして正しい動きをしているか判定するわけです。ということで、</p>
            <div class="stress"><p>正しい動きをしているか判定する機能</p></div>
            <p>によって駒の動きをコンピューターに覚えさせましょう。</p>
            <p>「いや、判定だけしたって動かせねーじゃん」って、まあその通りですよ。だから動かす機能も付けます。その話の前に、チェスには 6 種類の駒が白黒両陣営に 16 個ずつあります。これをどうやって表しましょうか。さっき board っていって 2 重リスト考えたでしょ。あれに値突っ込んでおきゃいいんじゃないですか。例えば WHITE を 1, ROOK を 2 にして</p>
            <div class="code">
                <pre>
                    <code>
board[a - 1][6 - 1] = WHITE * ROOK
                    </code>
                </pre>
            </div>
            <p>って表すとか。BLACK = -1 ってやれば board の値の正負で駒がどっちのものかわかりますし。ということで</p>
            <div class="stress">board[file][rank] = PLAYER * PIECE</div>
            <p>という構造を使っていきます。プレーヤーが駒を動かすのは、<a href="#s2-1">2-1</a> で言った「棋譜」の書き方でいいと思います。やたらめったら変な書き方じゃ汎用性低いですから。</p>
            <p>これでチェスのゲームをやるのに最低限必要な機能は揃いました。あとは補助的な、「これがあるとゲームっぽい」という機能を加えていきます。</p>
        </section>

        <section id="s2-3">
            <h2>2-3　勝敗</h2>
            <p>まあ勝敗なんて当人たちが勝手につければいいんですよ。いいんですけど、そりゃあゲーム作るうえで "GAME OVER..." みたいなのやりたいじゃないですか。やっぱし作りたいじゃないですか。それに棋譜では「チェックメイトの手」という記述をすることもあるくらいです。そんなワガママなプレーヤーさんのためにも勝敗判定してあげましょうよ。</p>
            <p>チェスにおいて勝敗は白勝ち・黒勝ちと引き分けの3種類、勝敗のつきかたはキングを取られる・チェックメイト・ステイルメイト・リザイン(投了)の 4 種類です。わからない人はもう一度ルールを確認しましょう。これをそれぞれ判断する機能も付けたいですね。</p>
            <p>チェックメイトを判断するには何よりチェックを判断できるようにならなければいけません。でもそんな難しいことではありませんよ。だって「相手のキングのいるマスに行けるか」判定すればいいんですから。そしてチェックの機能を使って「どうやって動いてもチェック」であればチェックメイトと判断すればいい。ステイルメイトだって、「今はチェックされていないけど、これからどう動いてもチェックされる」ということを判断すればいいので、そう頭を抱える問題ではありません。</p>
        </section>

        <section>
            <h2>次回予告</h2>
            <p>だいたいの概要が決まったところで、今度は本格的にコードを書いていきます。プログラムを書く準備はできているでしょうか。まあ、最初はボードゲーム作ったことのある人ならだれでもやったことがある「2次元配列」です。「それなら復習だぜ」って人もいるでしょうから、気楽に見ていきましょう。</p>
            <p><a href="../stage3/index.html">次回　Stage 3　盤面をつくる</a></p>
        </section>
    </main>

    <footer>
        <ul>
            <li>LAST EDITED: 2020/5/6</li>
            <li><a href="../../index.html">解説一覧</a></li>
            <li><a href="https://github.com/Saito-Saito-Saito" target="_blank">このページの作成者のGitHub</a></li>
            <li><a href="https://twitter.com/zsops_n" target="_blank">このページの作成者のTwitter</a></li>
            <li><a href="#">トップに戻る</a></li>
        </ul>
    </footer>
</body>
</html>